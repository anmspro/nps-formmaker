{"remainingRequest":"E:\\code\\vue-form-making\\node_modules\\babel-loader\\lib\\index.js!E:\\code\\vue-form-making\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\code\\vue-form-making\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\code\\vue-form-making\\src\\components\\Container.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\code\\vue-form-making\\src\\components\\Container.vue","mtime":1654425651739},{"path":"E:\\code\\vue-form-making\\package.json","mtime":1654423480823},{"path":"E:\\code\\vue-form-making\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1653903169935},{"path":"E:\\code\\vue-form-making\\node_modules\\babel-loader\\lib\\index.js","mtime":1653803163997},{"path":"E:\\code\\vue-form-making\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1653903169935},{"path":"E:\\code\\vue-form-making\\node_modules\\vue-loader\\lib\\index.js","mtime":1653903175370}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport _defineProperty from \"E:/code/vue-form-making/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Draggable from 'vuedraggable';\nimport WidgetConfig from \"./WidgetConfig\";\nimport FormConfig from \"./FormConfig\";\nimport WidgetForm from \"./WidgetForm\";\nimport CusDialog from \"./CusDialog\";\nimport GenerateForm from \"./GenerateForm\";\nimport Clipboard from 'clipboard';\nimport { basicComponents, layoutComponents, advanceComponents } from \"./componentsConfig.js\";\nimport { loadJs, loadCss } from \"../util/index.js\";\nimport request from \"../util/request.js\";\nimport generateCode from \"./generateCode.js\";\nexport default {\n  name: 'fm-making-form',\n  components: {\n    Draggable: Draggable,\n    WidgetConfig: WidgetConfig,\n    FormConfig: FormConfig,\n    WidgetForm: WidgetForm,\n    CusDialog: CusDialog,\n    GenerateForm: GenerateForm\n  },\n  props: {\n    preview: {\n      type: Boolean,\n      default: false\n    },\n    generateCode: {\n      type: Boolean,\n      default: false\n    },\n    generateJson: {\n      type: Boolean,\n      default: false\n    },\n    upload: {\n      type: Boolean,\n      default: false\n    },\n    clearable: {\n      type: Boolean,\n      default: false\n    },\n    basicFields: {\n      type: Array,\n      // Added nps\n      default: function _default() {\n        return ['input', 'textarea', 'number', 'radio', 'checkbox', 'time', 'date', 'rate', 'color', 'select', 'switch', 'slider', 'text', 'nps'];\n      }\n    },\n    advanceFields: {\n      type: Array,\n      default: function _default() {\n        return ['blank', 'imgupload', 'editor', 'cascader'];\n      }\n    },\n    layoutFields: {\n      type: Array,\n      default: function _default() {\n        return ['grid'];\n      }\n    }\n  },\n  data: function data() {\n    return {\n      basicComponents: basicComponents,\n      layoutComponents: layoutComponents,\n      advanceComponents: advanceComponents,\n      resetJson: false,\n      widgetForm: {\n        list: [],\n        config: {\n          labelWidth: 100,\n          labelPosition: 'right',\n          size: 'small'\n        }\n      },\n      configTab: 'widget',\n      widgetFormSelect: null,\n      previewVisible: false,\n      jsonVisible: false,\n      codeVisible: false,\n      uploadVisible: false,\n      remoteFuncs: {\n        func_test: function func_test(resolve) {\n          setTimeout(function () {\n            var options = [{\n              id: '1',\n              name: '1111'\n            }, {\n              id: '2',\n              name: '2222'\n            }, {\n              id: '3',\n              name: '3333'\n            }];\n            resolve(options);\n          }, 2000);\n        },\n        funcGetToken: function funcGetToken(resolve) {\n          request.get('http://tools-server.xiaoyaoji.cn/api/uptoken').then(function (res) {\n            resolve(res.uptoken);\n          });\n        },\n        upload_callback: function upload_callback(response, file, fileList) {\n          console.log('callback', response, file, fileList);\n        }\n      },\n      widgetModels: {},\n      blank: '',\n      htmlTemplate: '',\n      vueTemplate: '',\n      jsonTemplate: '',\n      uploadEditor: null,\n      jsonCopyValue: '',\n      jsonClipboard: null,\n      jsonEg: \"{\\n  \\\"list\\\": [],\\n  \\\"config\\\": {\\n    \\\"labelWidth\\\": 100,\\n    \\\"labelPosition\\\": \\\"top\\\",\\n    \\\"size\\\": \\\"small\\\"\\n  }\\n}\",\n      codeActiveName: 'vue'\n    };\n  },\n  mounted: function mounted() {\n    this._loadComponents();\n  },\n  methods: {\n    _loadComponents: function _loadComponents() {\n      var _this = this;\n\n      this.basicComponents = this.basicComponents.map(function (item) {\n        return _objectSpread(_objectSpread({}, item), {}, {\n          name: _this.$t(\"fm.components.fields.\".concat(item.type))\n        });\n      });\n      this.advanceComponents = this.advanceComponents.map(function (item) {\n        return _objectSpread(_objectSpread({}, item), {}, {\n          name: _this.$t(\"fm.components.fields.\".concat(item.type))\n        });\n      });\n      this.layoutComponents = this.layoutComponents.map(function (item) {\n        return _objectSpread(_objectSpread({}, item), {}, {\n          name: _this.$t(\"fm.components.fields.\".concat(item.type))\n        });\n      });\n    },\n    handleGoGithub: function handleGoGithub() {\n      window.location.href = 'https://github.com/GavinZhuLei/vue-form-making';\n    },\n    handleConfigSelect: function handleConfigSelect(value) {\n      this.configTab = value;\n    },\n    handleMoveEnd: function handleMoveEnd(evt) {\n      console.log('end', evt);\n    },\n    handleMoveStart: function handleMoveStart(_ref) {\n      var oldIndex = _ref.oldIndex;\n      console.log('start', oldIndex, this.basicComponents);\n    },\n    handleMove: function handleMove() {\n      return true;\n    },\n    handlePreview: function handlePreview() {\n      console.log(this.widgetForm);\n      this.previewVisible = true;\n    },\n    handleTest: function handleTest() {\n      var _this2 = this;\n\n      this.$refs.generateForm.getData().then(function (data) {\n        _this2.$alert(data, '').catch(function (e) {});\n\n        _this2.$refs.widgetPreview.end();\n      }).catch(function (e) {\n        _this2.$refs.widgetPreview.end();\n      });\n    },\n    handleReset: function handleReset() {\n      this.$refs.generateForm.reset();\n    },\n    handleGenerateJson: function handleGenerateJson() {\n      var _this3 = this;\n\n      this.jsonVisible = true;\n      this.jsonTemplate = this.widgetForm;\n      console.log(JSON.stringify(this.widgetForm));\n      this.$nextTick(function () {\n        var editor = ace.edit('jsoneditor');\n        editor.session.setMode(\"ace/mode/json\");\n\n        if (!_this3.jsonClipboard) {\n          _this3.jsonClipboard = new Clipboard('.json-btn');\n\n          _this3.jsonClipboard.on('success', function (e) {\n            _this3.$message.success(_this3.$t('fm.message.copySuccess'));\n          });\n        }\n\n        _this3.jsonCopyValue = JSON.stringify(_this3.widgetForm);\n      });\n    },\n    handleGenerateCode: function handleGenerateCode() {\n      this.codeVisible = true;\n      this.htmlTemplate = generateCode(JSON.stringify(this.widgetForm), 'html');\n      this.vueTemplate = generateCode(JSON.stringify(this.widgetForm), 'vue');\n      this.$nextTick(function () {\n        var editor = ace.edit('codeeditor');\n        editor.session.setMode(\"ace/mode/html\");\n        var vueeditor = ace.edit('vuecodeeditor');\n        vueeditor.session.setMode(\"ace/mode/html\");\n      });\n    },\n    handleUpload: function handleUpload() {\n      var _this4 = this;\n\n      this.uploadVisible = true;\n      this.$nextTick(function () {\n        _this4.uploadEditor = ace.edit('uploadeditor');\n\n        _this4.uploadEditor.session.setMode(\"ace/mode/json\");\n      });\n    },\n    handleUploadJson: function handleUploadJson() {\n      try {\n        this.setJSON(JSON.parse(this.uploadEditor.getValue()));\n        this.uploadVisible = false;\n      } catch (e) {\n        this.$message.error(e.message);\n        this.$refs.uploadJson.end();\n      }\n    },\n    handleClear: function handleClear() {\n      this.widgetForm = {\n        list: [],\n        config: {\n          labelWidth: 100,\n          labelPosition: 'right',\n          size: 'small',\n          customClass: ''\n        }\n      };\n      this.widgetFormSelect = {};\n    },\n    clear: function clear() {\n      this.handleClear();\n    },\n    getJSON: function getJSON() {\n      return this.widgetForm;\n    },\n    getHtml: function getHtml() {\n      return generateCode(JSON.stringify(this.widgetForm));\n    },\n    setJSON: function setJSON(json) {\n      this.widgetForm = json;\n\n      if (json.list.length > 0) {\n        this.widgetFormSelect = json.list[0];\n      }\n    },\n    handleInput: function handleInput(val) {\n      console.log(val);\n      this.blank = val;\n    },\n    handleDataChange: function handleDataChange(field, value, data) {\n      console.log(field, value, data);\n    }\n  },\n  watch: {\n    widgetForm: {\n      deep: true,\n      handler: function handler(val) {\n        console.log(this.$refs.widgetForm);\n      }\n    },\n    '$lang': function $lang(val) {\n      this._loadComponents();\n    }\n  }\n};",{"version":3,"mappings":"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","names":["name","components","Draggable","WidgetConfig","FormConfig","WidgetForm","CusDialog","GenerateForm","props","preview","type","default","generateCode","generateJson","upload","clearable","basicFields","advanceFields","layoutFields","data","basicComponents","layoutComponents","advanceComponents","resetJson","widgetForm","list","config","labelWidth","labelPosition","size","configTab","widgetFormSelect","previewVisible","jsonVisible","codeVisible","uploadVisible","remoteFuncs","func_test","resolve","setTimeout","id","funcGetToken","request","upload_callback","response","file","fileList","console","widgetModels","blank","htmlTemplate","vueTemplate","jsonTemplate","uploadEditor","jsonCopyValue","jsonClipboard","jsonEg","codeActiveName","mounted","methods","_loadComponents","item","handleGoGithub","window","handleConfigSelect","value","handleMoveEnd","evt","handleMoveStart","handleMove","handlePreview","handleTest","catch","handleReset","handleGenerateJson","editor","handleGenerateCode","vueeditor","handleUpload","handleUploadJson","handleClear","customClass","clear","getJSON","getHtml","setJSON","json","handleInput","val","handleDataChange","field","watch","deep","handler"],"sourceRoot":"src/components","sources":["Container.vue"],"sourcesContent":["<template>\r\n  <div class=\"fm-style\">\r\n    <el-container class=\"fm2-container\">\r\n      <el-main class=\"fm2-main\">\r\n        <el-container>\r\n          <el-aside width=\"250px\">\r\n            <div class=\"components-list\">\r\n              <template v-if=\"basicFields.length\">\r\n                <div class=\"widget-cate\">{{$t('fm.components.basic.title')}}</div>\r\n                <draggable tag=\"ul\" :list=\"basicComponents\" \r\n                  v-bind=\"{group:{ name:'people', pull:'clone',put:false},sort:false, ghostClass: 'ghost'}\"\r\n                  @end=\"handleMoveEnd\"\r\n                  @start=\"handleMoveStart\"\r\n                  :move=\"handleMove\"\r\n                >\r\n                  <template v-for=\"(item, index) in basicComponents\">\r\n                    <li v-if=\"basicFields.indexOf(item.type)>=0\" class=\"form-edit-widget-label\" :class=\"{'no-put': item.type == 'divider'}\" :key=\"index\">\r\n                      <a>\r\n                        <i class=\"icon iconfont\" :class=\"item.icon\"></i>\r\n                        <span>{{item.name}}</span>\r\n                      </a>\r\n                    </li>\r\n                  </template>                \r\n                </draggable>\r\n              </template>            \r\n              <template v-if=\"advanceFields.length\">\r\n                <div class=\"widget-cate\">{{$t('fm.components.advance.title')}}</div>\r\n                <draggable tag=\"ul\" :list=\"advanceComponents\" \r\n                  v-bind=\"{group:{ name:'people', pull:'clone',put:false},sort:false, ghostClass: 'ghost'}\"\r\n                  @end=\"handleMoveEnd\"\r\n                  @start=\"handleMoveStart\"\r\n                  :move=\"handleMove\"\r\n                >\r\n                  <template v-for=\"(item, index) in advanceComponents\">\r\n                    <li v-if=\"advanceFields.indexOf(item.type) >= 0\" class=\"form-edit-widget-label\" :class=\"{'no-put': item.type == 'table'}\" :key=\"index\">\r\n                      <a>\r\n                        <i class=\"icon iconfont\" :class=\"item.icon\"></i>\r\n                        <span>{{item.name}}</span>\r\n                      </a>\r\n                    </li>                  \r\n                  </template>\r\n                </draggable>\r\n              </template>\r\n\r\n              \r\n              <template v-if=\"layoutFields.length\">\r\n                <div class=\"widget-cate\">{{$t('fm.components.layout.title')}}</div>\r\n                <draggable tag=\"ul\" :list=\"layoutComponents\" \r\n                  v-bind=\"{group:{ name:'people', pull:'clone',put:false},sort:false, ghostClass: 'ghost'}\"\r\n                  @end=\"handleMoveEnd\"\r\n                  @start=\"handleMoveStart\"\r\n                  :move=\"handleMove\"\r\n                >\r\n                  <template v-for=\"(item, index) in layoutComponents\">\r\n                    <li v-if=\"layoutFields.indexOf(item.type) >=0\" class=\"form-edit-widget-label no-put\" :key=\"index\">\r\n                      <a>\r\n                        <i class=\"icon iconfont\" :class=\"item.icon\"></i>\r\n                        <span>{{item.name}}</span>\r\n                      </a>\r\n                    </li>\r\n                  </template>               \r\n                </draggable>\r\n              </template>\r\n              \r\n            </div>\r\n            \r\n          </el-aside>\r\n          \r\n          <el-container class=\"center-container\" direction=\"vertical\">\r\n            <el-header class=\"btn-bar\" style=\"height: 45px;\">\r\n              <slot name=\"action\">\r\n              </slot>\r\n              <el-button v-if=\"upload\" type=\"text\" size=\"medium\" icon=\"el-icon-upload2\" @click=\"handleUpload\">{{$t('fm.actions.import')}}</el-button>\r\n              <el-button v-if=\"clearable\" type=\"text\" size=\"medium\" icon=\"el-icon-delete\" @click=\"handleClear\">{{$t('fm.actions.clear')}}</el-button>\r\n              <el-button v-if=\"preview\" type=\"text\" size=\"medium\" icon=\"el-icon-view\" @click=\"handlePreview\">{{$t('fm.actions.preview')}}</el-button>\r\n              <el-button v-if=\"generateJson\" type=\"text\" size=\"medium\" icon=\"el-icon-tickets\" @click=\"handleGenerateJson\">{{$t('fm.actions.json')}}</el-button>\r\n              <el-button v-if=\"generateCode\" type=\"text\" size=\"medium\" icon=\"el-icon-document\" @click=\"handleGenerateCode\">{{$t('fm.actions.code')}}</el-button>\r\n            </el-header>\r\n            <el-main :class=\"{'widget-empty': widgetForm.list.length == 0}\">\r\n              \r\n              <widget-form v-if=\"!resetJson\"  ref=\"widgetForm\" :data=\"widgetForm\" :select.sync=\"widgetFormSelect\"></widget-form>\r\n            </el-main>\r\n          </el-container>\r\n          \r\n          <el-aside class=\"widget-config-container\">\r\n            <el-container>\r\n              <el-header height=\"45px\">\r\n                <div class=\"config-tab\" :class=\"{active: configTab=='widget'}\" @click=\"handleConfigSelect('widget')\">{{$t('fm.config.widget.title')}}</div>\r\n                <div class=\"config-tab\" :class=\"{active: configTab=='form'}\" @click=\"handleConfigSelect('form')\">{{$t('fm.config.form.title')}}</div>\r\n              </el-header>\r\n              <el-main class=\"config-content\">\r\n                <widget-config v-show=\"configTab=='widget'\" :data=\"widgetFormSelect\"></widget-config>\r\n                <form-config v-show=\"configTab=='form'\" :data=\"widgetForm.config\"></form-config>\r\n              </el-main>\r\n            </el-container>\r\n            \r\n          </el-aside>\r\n\r\n          <cus-dialog\r\n            :visible=\"previewVisible\"\r\n            @on-close=\"previewVisible = false\"\r\n            ref=\"widgetPreview\"\r\n            width=\"1000px\"\r\n            form\r\n          >\r\n            <generate-form insite=\"true\" @on-change=\"handleDataChange\" v-if=\"previewVisible\" :data=\"widgetForm\" :value=\"widgetModels\" :remote=\"remoteFuncs\" ref=\"generateForm\">\r\n\r\n              <template v-slot:blank=\"scope\">\r\n                Width <el-input v-model=\"scope.model.blank.width\" style=\"width: 100px\"></el-input>\r\n                Height <el-input v-model=\"scope.model.blank.height\" style=\"width: 100px\"></el-input>\r\n              </template>\r\n            </generate-form>\r\n\r\n            <template slot=\"action\">\r\n              <el-button type=\"primary\" @click=\"handleTest\">{{$t('fm.actions.getData')}}</el-button>\r\n              <el-button @click=\"handleReset\">{{$t('fm.actions.reset')}}</el-button>\r\n            </template>\r\n          </cus-dialog>\r\n\r\n          <cus-dialog\r\n            :visible=\"uploadVisible\"\r\n            @on-close=\"uploadVisible = false\"\r\n            @on-submit=\"handleUploadJson\"\r\n            ref=\"uploadJson\"\r\n            width=\"800px\"\r\n            form\r\n          >\r\n            <el-alert type=\"info\" :title=\"$t('fm.description.uploadJsonInfo')\"></el-alert>\r\n            <div id=\"uploadeditor\" style=\"height: 400px;width: 100%;\">{{jsonEg}}</div>\r\n          </cus-dialog>\r\n\r\n          <cus-dialog\r\n            :visible=\"jsonVisible\"\r\n            @on-close=\"jsonVisible = false\"\r\n            ref=\"jsonPreview\"\r\n            width=\"800px\"\r\n            form\r\n          >\r\n            \r\n            <div id=\"jsoneditor\" style=\"height: 400px;width: 100%;\">{{jsonTemplate}}</div>\r\n            \r\n            <template slot=\"action\">\r\n              <el-button type=\"primary\" class=\"json-btn\" :data-clipboard-text=\"jsonCopyValue\">{{$t('fm.actions.copyData')}}</el-button>\r\n            </template>\r\n          </cus-dialog>\r\n\r\n          <cus-dialog\r\n            :visible=\"codeVisible\"\r\n            @on-close=\"codeVisible = false\"\r\n            ref=\"codePreview\"\r\n            width=\"800px\"\r\n            form\r\n            :action=\"false\"\r\n          >\r\n            <!-- <div id=\"codeeditor\" style=\"height: 500px; width: 100%;\">{{htmlTemplate}}</div> -->\r\n            <el-tabs type=\"border-card\" style=\"box-shadow: none;\" v-model=\"codeActiveName\">\r\n              <el-tab-pane label=\"Vue Component\" name=\"vue\">\r\n                <div id=\"vuecodeeditor\" style=\"height: 500px; width: 100%;\">{{vueTemplate}}</div>\r\n              </el-tab-pane>\r\n              <el-tab-pane label=\"HTML\" name=\"html\">\r\n                <div id=\"codeeditor\" style=\"height: 500px; width: 100%;\">{{htmlTemplate}}</div>\r\n              </el-tab-pane>\r\n            </el-tabs>\r\n          </cus-dialog>\r\n        </el-container>\r\n      </el-main>\r\n      <el-footer height=\"30px\" style=\"font-weight: 600;\">Powered by <a target=\"_blank\" href=\"https://www.reddotdigitalit.com/\">Red.Digital Limited</a></el-footer>\r\n    </el-container>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Draggable from 'vuedraggable'\r\nimport WidgetConfig from './WidgetConfig'\r\nimport FormConfig from './FormConfig'\r\nimport WidgetForm from './WidgetForm'\r\nimport CusDialog from './CusDialog'\r\nimport GenerateForm from './GenerateForm'\r\nimport Clipboard from 'clipboard'\r\nimport {basicComponents, layoutComponents, advanceComponents} from './componentsConfig.js'\r\nimport {loadJs, loadCss} from '../util/index.js'\r\nimport request from '../util/request.js'\r\nimport generateCode from './generateCode.js'\r\n\r\nexport default {\r\n  name: 'fm-making-form',\r\n  components: {\r\n    Draggable,\r\n    WidgetConfig,\r\n    FormConfig,\r\n    WidgetForm,\r\n    CusDialog,\r\n    GenerateForm\r\n  },\r\n  props: {\r\n    preview: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    generateCode: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    generateJson: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    upload: {\r\n      type: Boolean, \r\n      default: false\r\n    },\r\n    clearable: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    basicFields: {\r\n      type: Array,\r\n      // Added nps\r\n      default: () => ['input', 'textarea', 'number', 'radio', 'checkbox', 'time', 'date', 'rate', 'color', 'select', 'switch', 'slider', 'text', 'nps']\r\n    },\r\n    advanceFields: {\r\n      type: Array,\r\n      default: () => ['blank', 'imgupload', 'editor', 'cascader']\r\n    },\r\n    layoutFields: {\r\n      type: Array,\r\n      default: () => ['grid']\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n      basicComponents,\r\n      layoutComponents,\r\n      advanceComponents,\r\n      resetJson: false,\r\n      widgetForm: {\r\n        list: [],\r\n        config: {\r\n          labelWidth: 100,\r\n          labelPosition: 'right',\r\n          size: 'small'\r\n        },\r\n      },\r\n      configTab: 'widget',\r\n      widgetFormSelect: null,\r\n      previewVisible: false,\r\n      jsonVisible: false,\r\n      codeVisible: false,\r\n      uploadVisible: false,\r\n      remoteFuncs: {\r\n        func_test (resolve) {\r\n          setTimeout(() => {\r\n            const options = [\r\n              {id: '1', name: '1111'},\r\n              {id: '2', name: '2222'},\r\n              {id: '3', name: '3333'}\r\n            ]\r\n\r\n            resolve(options)\r\n          }, 2000)\r\n        },\r\n        funcGetToken (resolve) {\r\n          request.get('http://tools-server.xiaoyaoji.cn/api/uptoken').then(res => {\r\n            resolve(res.uptoken)\r\n          })\r\n        },\r\n        upload_callback (response, file, fileList) {\r\n          console.log('callback', response, file, fileList)\r\n        }\r\n      },\r\n      widgetModels: {},\r\n      blank: '',\r\n      htmlTemplate: '',\r\n      vueTemplate: '',\r\n      jsonTemplate: '',\r\n      uploadEditor: null,\r\n      jsonCopyValue: '',\r\n      jsonClipboard: null,\r\n      jsonEg: `{\r\n  \"list\": [],\r\n  \"config\": {\r\n    \"labelWidth\": 100,\r\n    \"labelPosition\": \"top\",\r\n    \"size\": \"small\"\r\n  }\r\n}`,\r\n      codeActiveName: 'vue',\r\n    }\r\n  },\r\n  mounted () {\r\n    this._loadComponents()\r\n  },\r\n  methods: {\r\n    _loadComponents () {\r\n      this.basicComponents = this.basicComponents.map(item => {\r\n        return {\r\n          ...item,\r\n          name: this.$t(`fm.components.fields.${item.type}`)\r\n        }\r\n      })\r\n      this.advanceComponents = this.advanceComponents.map(item => {\r\n        return {\r\n          ...item,\r\n          name: this.$t(`fm.components.fields.${item.type}`)\r\n        }\r\n      })\r\n      this.layoutComponents = this.layoutComponents.map(item => {\r\n        return {\r\n          ...item,\r\n          name: this.$t(`fm.components.fields.${item.type}`)\r\n        }\r\n      })\r\n    },\r\n    handleGoGithub () {\r\n      window.location.href = 'https://github.com/GavinZhuLei/vue-form-making'\r\n    },\r\n    handleConfigSelect (value) {\r\n      this.configTab = value\r\n    },\r\n    handleMoveEnd (evt) {\r\n      console.log('end', evt)\r\n    },\r\n    handleMoveStart ({oldIndex}) {\r\n      console.log('start', oldIndex, this.basicComponents)\r\n    },\r\n    handleMove () {\r\n      return true\r\n    },\r\n    handlePreview () {\r\n      console.log(this.widgetForm)\r\n      this.previewVisible = true\r\n    },\r\n    handleTest () {\r\n      this.$refs.generateForm.getData().then(data => {\r\n        this.$alert(data, '').catch(e=>{})\r\n        this.$refs.widgetPreview.end()\r\n      }).catch(e => {\r\n        this.$refs.widgetPreview.end()\r\n      })\r\n    },\r\n    handleReset () {\r\n      this.$refs.generateForm.reset()\r\n    },\r\n    handleGenerateJson () {\r\n      this.jsonVisible = true\r\n      this.jsonTemplate = this.widgetForm\r\n      console.log(JSON.stringify(this.widgetForm))\r\n      this.$nextTick(() => {\r\n\r\n        const editor = ace.edit('jsoneditor')\r\n        editor.session.setMode(\"ace/mode/json\")\r\n\r\n        if (!this.jsonClipboard) {\r\n          this.jsonClipboard = new Clipboard('.json-btn')\r\n          this.jsonClipboard.on('success', (e) => {\r\n            this.$message.success(this.$t('fm.message.copySuccess'))\r\n          })\r\n        }\r\n        this.jsonCopyValue = JSON.stringify(this.widgetForm)\r\n      })\r\n    },\r\n    handleGenerateCode () {\r\n\r\n      this.codeVisible = true\r\n      this.htmlTemplate = generateCode(JSON.stringify(this.widgetForm), 'html')\r\n      this.vueTemplate = generateCode(JSON.stringify(this.widgetForm), 'vue')\r\n      this.$nextTick(() => {\r\n        const editor = ace.edit('codeeditor')\r\n        editor.session.setMode(\"ace/mode/html\")\r\n\r\n        const vueeditor = ace.edit('vuecodeeditor')\r\n        vueeditor.session.setMode(\"ace/mode/html\")\r\n      })\r\n    },\r\n    handleUpload () {\r\n      this.uploadVisible = true\r\n      this.$nextTick(() => {\r\n        this.uploadEditor = ace.edit('uploadeditor')\r\n        this.uploadEditor.session.setMode(\"ace/mode/json\")\r\n      })\r\n    },\r\n    handleUploadJson () {\r\n      try {\r\n        this.setJSON(JSON.parse(this.uploadEditor.getValue()))\r\n        this.uploadVisible = false\r\n      } catch (e) {\r\n        this.$message.error(e.message)\r\n        this.$refs.uploadJson.end()\r\n      }\r\n    },\r\n    handleClear () {\r\n      this.widgetForm = {\r\n        list: [],\r\n        config: {\r\n          labelWidth: 100,\r\n          labelPosition: 'right',\r\n          size: 'small',\r\n          customClass: ''\r\n        },\r\n      }\r\n\r\n      this.widgetFormSelect = {}\r\n    },\r\n    clear () {\r\n      this.handleClear()\r\n    },\r\n    getJSON () {\r\n      return this.widgetForm\r\n    },\r\n    getHtml () {\r\n      return generateCode(JSON.stringify(this.widgetForm))\r\n    },\r\n    setJSON (json) {\r\n      this.widgetForm = json\r\n\r\n      if (json.list.length> 0) {\r\n        this.widgetFormSelect = json.list[0]\r\n      }\r\n    },\r\n    handleInput (val) {\r\n      console.log(val)\r\n      this.blank = val\r\n    },\r\n    handleDataChange (field, value, data) {\r\n      console.log(field, value, data)\r\n    }\r\n  },\r\n  watch: {\r\n    widgetForm: {\r\n      deep: true,\r\n      handler: function (val) {\r\n        console.log(this.$refs.widgetForm)\r\n      }\r\n    },\r\n    '$lang': function (val) {\r\n      this._loadComponents()\r\n    }\r\n  }\r\n}\r\n</script>\r\n"]}]}